# Makefile for CSE 13S, Spring 2023, Assignment 3

# DO NOT EDIT THIS FILE

# Usage:
#
#    $ make             Make the sorting program (ready for LLDB debugging).
#    $ make all
#
#    $ make clean       Type this command after editing this Makefile or
#                       when switching between all and release targets.
#
#    $ make format      Run clang-format on *.c and *.h
#
#    $ make release     Make the sorting program (without debugging info).
#                       We use this for the reference design.


CC=clang
debug:   CFLAGS=-Wall -Wextra -Wstrict-prototypes -Werror -pedantic -gdwarf-4
release: CFLAGS=-Wall -Wextra -Wstrict-prototypes -Werror -pedantic
LDFLAGS=-lm

EXECBIN=huff
EXEC1 = bwtest
EXEC2 = nodetest
EXEC3 = pqtest

OBJS =huff.o pq.o bitwriter.o node.o
LIBS1 = io-x86_64.a
BITWRITE = bitwriter.o bwtest.o
NODE = node.o bitwriter.o nodetest.o
PRIOQ = pq.o bitwriter.o node.o pqtest.o
TESTS = bwtest.o pqtest.o nodetest.o
.PHONY: all debug release clean

all: huff bwtest nodetest pqtest

debug: $(EXECBIN) 

release: $(EXECBIN)

$(EXECBIN): $(OBJS) $(LIBS1) 
	$(CC) $(LDFLAGS) -o $@ $^
$(EXEC1): $(BITWRITE) $(LIBS1)
	$(CC) $(LDFLAGS) -o $@ $^
$(EXEC2): $(NODE) $(LIBS1) 
	$(CC) $(LDFLAGS) -o $@ $^
$(EXEC3): $(PRIOQ) $(LIBS1) 
	$(CC) $(LDFLAGS) -o $@ $^
%.o : %.c
	$(CC) $(CFLAGS) -c $<

clean:
	rm -f $(EXECBIN) $(EXEC1) $(EXEC2) $(EXEC3) $(OBJS) $(TESTS)

format:
	clang-format -i --style=file *.[ch]

scan-build: clean
	scan-build --use-cc=$(CC) make

